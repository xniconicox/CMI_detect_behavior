# モデルフローまとめ (単一ステージ版)

このドキュメントでは、従来の18クラス分類のみを行うシンプルなモデルフローを整理します。前処理手順は [前処理フローまとめ](preprocessing_flow_jp.md) に従います。

## 1. モデル一覧と入力

| モデル | 主な入力特徴量 | 備考 |
|-------|----------------|------|
| LightGBM/CatBoost | Tabular 120次元特徴量 (Block I) | 特徴量重要度が確認しやすい |
| GRU / CNN-GRU | IMUウィンドウテンソル + Demographics (Block J + F) | LSTMTrainer で学習 |
| ToF-3D-CNN | ToF 3Dボクセルテンソル (Block K) | ボクセル化したToF画像をCNNで処理 |

## 2. 学習フロー
1. 前処理済みデータをモデルごとの形式に変換
2. クロスバリデーションでハイパーパラメータを探索
3. `src/train.py` などのスクリプトで学習

## 3. 推論フロー
1. テストデータを同じ前処理パイプラインに通す
2. 学習済みモデルで18クラスの確率分布を出力
3. 必要に応じてアンサンブルや後処理を実施

---
この単一ステージ版では BFRB/Non-BFRB を分ける事前ステージを設けず、全サンプルに対し直接18クラス分類モデルを適用します。誤検出が多い場合は [ステージ型モデル](model_flow_two_stage_jp.md) を検討してください。
